<div class="auth-container" style="max-width: 1200px; margin: auto; padding: 20px; text-align: center;">
  <h1 style="font-size: 32px; color: #003366; font-weight: bold;">List of Events</h1>
  <hr style="border: 1px solid #003366; width: 50%; margin: 20px auto;">
  <p style="font-size: 18px; color: #333; margin-bottom: 20px;">
    You are looking for a past or future event? Look in the years past, present, or future to see our history.
  </p>

  <!-- Year Buttons -->
  <div style="display: flex; justify-content: center; margin-bottom: 20px; flex-wrap: wrap;">
    <% @events_by_year.keys.each do |year| %>
      <div class="year-container" style="margin: 0 20px; text-align: center;padding-bottom: 10px;">
        <button class="year-btn" data-year="<%= year %>" style="background-color: #003366; color: white; padding: 12px 24px; border: none; cursor: pointer; border-radius: 25px; font-size: 16px; font-weight: bold; transition: background-color 0.3s, transform 0.2s; min-height: 45px;">
          <%= year %>
        </button>

        <!-- Month Buttons -->
        <div id="months-<%= year %>" class="month-buttons" style="display: none; margin-top: 10px;">
          <% (1..12).each do |month| %>
            <% has_events = @events_by_year[year]&.key?(month) %>
            <% if has_events %>
              <div class="month-item" data-month="<%= month %>" data-year="<%= year %>" style="padding: 8px 18px; cursor: pointer; color: #333; font-size: 14px; border: 1px solid #ccc; margin-bottom: 5px; border-radius: 5px; background-color: #f1f1f1; transition: background-color 0.3s, transform 0.2s; width: 100%; text-align: center;">
                <%= Date::MONTHNAMES[month] %>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Show All Events Button -->
  <button id="show-all-events" style="margin-top: 20px; padding: 10px 20px; background-color: #336600; color: white; border: none; cursor: pointer; border-radius: 5px; font-size: 16px; font-weight: bold; transition: background-color 0.3s;">Show All Events</button>

  <!-- Events Display -->
  <div id="events-container" style="text-align: center; margin-top: 30px;">
    <h2 id="selected-month" style="color: black; margin-bottom: 20px;">All Events</h2>
    <div id="events-list" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; padding: 20px;">
      <% @events.each do |event| %>
        <div class="event-card card shadow rounded col-md-3" data-year="<%= event.date.year %>" data-month="<%= event.date.month %>" style="border: 2px solid #007bff; border-radius: 15px; overflow: hidden;">
          <div class="card-body" style="background-color: #f8f9fa; padding: 20px;">
            <h5 class="card-title" style="font-size: 18px; color: #003366; margin-bottom: 15px; font-weight: bold; text-align: center;"><%= event.author %></h5>
            <p class="card-text"><strong>Location:</strong> <%= event.location %></p>
            <p class="card-text"><strong>Date:</strong> <%= event.date.strftime("%B %d, %Y") %></p>
            <p class="card-text"><strong>Duration:</strong> <%= event.duration %> minutes</p>
            <p class="card-text"><strong>Price:</strong> <%= event.price %> â‚¬</p>
            <div style="display: flex; justify-content: center; margin-top: 20px;">
              <a href="/events/<%= event.id %>" class="btn btn-primary" style="width: 100%; font-size: 14px; font-weight: bold; border-radius: 25px; padding: 10px 20px; text-align: center; display: inline-block;">View Event</a>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const yearButtons = document.querySelectorAll('.year-btn');
    const monthItems = document.querySelectorAll('.month-item');
    const eventCards = document.querySelectorAll('.event-card');
    const showAllEventsBtn = document.getElementById('show-all-events');
    const selectedMonth = document.getElementById('selected-month');

    function showAllEvents() {
      eventCards.forEach(card => card.style.display = "block");
      selectedMonth.textContent = "All Events";
    }

    yearButtons.forEach(button => {
      button.addEventListener('click', function() {
        const year = button.getAttribute('data-year');
        selectedMonth.textContent = `Events of ${year}`;

        eventCards.forEach(card => {
          card.style.display = card.getAttribute('data-year') === year ? "block" : "none";
        });

        document.querySelectorAll('.month-buttons').forEach(m => m.style.display = 'none');
        document.getElementById(`months-${year}`).style.display = 'block';
      });
    });

    monthItems.forEach(monthItem => {
      monthItem.addEventListener('click', function() {
        const year = this.getAttribute('data-year');
        const month = this.getAttribute('data-month');
        selectedMonth.textContent = `Events of ${this.textContent} ${year}`;

        eventCards.forEach(card => {
          card.style.display = (card.getAttribute('data-year') === year && card.getAttribute('data-month') === month) ? "block" : "none";
        });

        document.querySelectorAll('.month-buttons').forEach(m => m.style.display = 'none');
      });
    });

    showAllEventsBtn.addEventListener('click', showAllEvents);

    document.addEventListener('click', function(event) {
      if (!event.target.closest('.year-container')) {
        document.querySelectorAll('.month-buttons').forEach(m => m.style.display = 'none');
      }
    });

    showAllEvents();
  });
</script>
